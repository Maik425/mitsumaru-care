## ADDED Requirements

### Requirement: 役職マスター管理機能

システム管理者および施設管理者は、役職マスターを登録・管理できる。

#### Scenario: 施設管理者による役職登録

- **WHEN** 施設管理者が新しい役職情報を入力して登録ボタンをクリック
- **THEN** positionsテーブルにレコードが追加される
- **AND** 作成された役職は施設管理者の所属施設に自動的に紐づけられる

#### Scenario: システム管理者による役職登録

- **WHEN** システム管理者が新しい役職情報を入力して登録ボタンをクリック
- **THEN** positionsテーブルにレコードが追加される
- **AND** システム管理者は任意の施設を選択して役職を紐づけられる

#### Scenario: 役職登録時のバリデーション

- **WHEN** 必須項目が未入力または無効な値が入力された場合
- **THEN** 適切なエラーメッセージが表示される
- **AND** 役職登録は実行されない

### Requirement: 役職一覧表示機能

管理者は、管理対象の役職一覧を表示できる。

#### Scenario: 施設管理者による役職一覧表示

- **WHEN** 施設管理者が役職管理画面にアクセス
- **THEN** 所属施設の役職のみが一覧表示される
- **AND** 各役職の基本情報（名前、説明、レベル、色コード）が表示される

#### Scenario: システム管理者による役職一覧表示

- **WHEN** システム管理者が役職管理画面にアクセス
- **THEN** 全施設の役職が一覧表示される
- **AND** 施設別フィルタリング機能が利用できる

### Requirement: 役職編集機能

管理者は、既存の役職情報を編集できる。

#### Scenario: 役職情報の更新

- **WHEN** 管理者が役職情報を編集して保存ボタンをクリック
- **THEN** positionsテーブルの該当レコードが更新される
- **AND** 変更内容が即座に一覧に反映される

#### Scenario: 権限による編集制限

- **WHEN** 施設管理者が他施設の役職情報を編集しようとした場合
- **THEN** エラーメッセージが表示される
- **AND** 編集は実行されない

### Requirement: 役職削除機能

管理者は、不要になった役職を削除できる。

#### Scenario: 役職の削除

- **WHEN** 管理者が役職削除ボタンをクリックして確認する
- **THEN** positionsテーブルからレコードが削除される
- **AND** 関連する職員役職情報も削除される（外部キー制約による）

### Requirement: 職員役職管理機能

管理者は、職員に役職を割り当て・管理できる。

#### Scenario: 職員への役職割り当て

- **WHEN** 管理者が職員に新しい役職を割り当てる
- **THEN** user_positionsテーブルにレコードが追加される
- **AND** 職員の現在役職が更新される

#### Scenario: 職員役職の更新

- **WHEN** 管理者が職員の役職を変更する
- **THEN** user_positionsテーブルに新しいレコードが追加される
- **AND** 職員の現在役職が更新される

#### Scenario: 職員からの役職削除

- **WHEN** 管理者が職員から役職を削除する
- **THEN** user_positionsテーブルから該当レコードが削除される
- **AND** 職員の現在役職が更新される

### Requirement: 職員役職一覧表示機能

管理者は、職員の役職一覧を表示できる。

#### Scenario: 職員役職一覧の表示

- **WHEN** 管理者が職員役職管理画面にアクセス
- **THEN** 所属施設の職員とその役職が一覧表示される
- **AND** 各職員の現在役職と役職履歴が表示される

#### Scenario: 役職別フィルタリング

- **WHEN** 管理者が特定の役職でフィルタリングする
- **THEN** 該当役職を持つ職員のみが表示される

## MODIFIED Requirements

### Requirement: アカウント管理システム

既存のアカウント管理システムに役職選択機能を統合する。

#### Scenario: 新規アカウント作成時の役職選択

- **WHEN** 管理者が新規アカウントを作成する
- **THEN** 所属施設の役職一覧から選択できる
- **AND** 選択された役職が職員に自動的に割り当てられる

#### Scenario: 既存アカウントの役職変更

- **WHEN** 管理者が既存アカウントの役職を変更する
- **THEN** 職員の現在役職が更新される
- **AND** 役職変更履歴が記録される

### Requirement: 役割表管理システム

既存の役割表管理システムに役職選択機能を統合する。

#### Scenario: 役割表での役職選択

- **WHEN** 管理者が役割表を作成・編集する
- **THEN** 所属施設の役職一覧から選択できる
- **AND** 役職別の職員配置が可能である

#### Scenario: 役職要件に基づく職員検索

- **WHEN** 管理者が特定の役職要件で職員を検索する
- **THEN** 該当する役職を持つ職員が検索結果に表示される
- **AND** 役職レベルによる絞り込みが可能である

### Requirement: シフト管理システム

既存のシフト管理システムに役職情報を統合する。

#### Scenario: シフト作成時の役職考慮

- **WHEN** 管理者がシフトを作成する
- **THEN** 各時間帯に必要な役職を指定できる
- **AND** 該当役職を持つ職員が自動的に候補に表示される

#### Scenario: 役職別シフト表示

- **WHEN** 管理者がシフト表を表示する
- **THEN** 各職員の役職情報が併せて表示される
- **AND** 役職別の色分け表示が可能である
