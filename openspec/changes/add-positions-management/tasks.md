## 1. データベース設計・実装

- [ ] 1.1 役職マスターテーブルの設計・作成
  - [ ] 1.1.1 positionsテーブルの作成（id, name, description, level, color_code, facility_id, is_active）
  - [ ] 1.1.2 インデックスと制約の設定
  - [ ] 1.1.3 RLSポリシーの設定
- [ ] 1.2 職員役職関連テーブルの設計・作成
  - [ ] 1.2.1 user_positionsテーブルの作成（user_id, position_id, assigned_at, assigned_by）
  - [ ] 1.2.2 外部キー制約の設定
  - [ ] 1.2.3 RLSポリシーの設定
- [ ] 1.3 既存usersテーブルの拡張
  - [ ] 1.3.1 position_idカラムの追加（現在の役職を保持）
- [ ] 1.4 マイグレーションファイルの作成・実行
- [ ] 1.5 ダミーデータの挿入

## 2. バックエンド実装

- [ ] 2.1 役職DTOの作成
  - [ ] 2.1.1 Position型定義の作成
  - [ ] 2.1.2 UserPosition型定義の作成
  - [ ] 2.1.3 リクエスト・レスポンス型の定義
- [ ] 2.2 役職リポジトリの実装
  - [ ] 2.2.1 PositionsRepositoryクラスの作成
  - [ ] 2.2.2 役職CRUD操作の実装
  - [ ] 2.2.3 職員役職管理メソッドの実装
- [ ] 2.3 tRPCルーターの実装
  - [ ] 2.3.1 役職管理ルーター（positions.ts）
    - [ ] 2.3.1.1 役職一覧取得（list）
    - [ ] 2.3.1.2 役職作成（create）
    - [ ] 2.3.1.3 役職更新（update）
    - [ ] 2.3.1.4 役職削除（delete）
  - [ ] 2.3.2 職員役職管理ルーター（user-positions.ts）
    - [ ] 2.3.2.1 職員役職一覧取得（getByUser）
    - [ ] 2.3.2.2 職員役職割り当て（assignToUser）
    - [ ] 2.3.2.3 職員役職更新（updateUserPosition）
    - [ ] 2.3.2.4 職員役職削除（removeFromUser）

## 3. フロントエンド実装

- [ ] 3.1 役職登録コンポーネントの修正
  - [ ] 3.1.1 tRPCクライアントの統合
  - [ ] 3.1.2 役職一覧の取得・表示
  - [ ] 3.1.3 役職作成フォームの実装
  - [ ] 3.1.4 役職編集機能の実装
  - [ ] 3.1.5 役職削除機能の実装
- [ ] 3.2 アカウント管理コンポーネントの修正
  - [ ] 3.2.1 役職選択の動的化（APIから取得）
  - [ ] 3.2.2 新規アカウント作成時の役職割り当て
- [ ] 3.3 役割表管理コンポーネントの修正
  - [ ] 3.3.1 役職選択の動的化（APIから取得）
  - [ ] 3.3.2 役職別フィルタリング機能の実装
- [ ] 3.4 施設別管理機能の実装
  - [ ] 3.4.1 施設管理者の所属施設取得
  - [ ] 3.4.2 施設別役職フィルタリング
- [ ] 3.5 エラーハンドリングとローディング状態の実装
- [ ] 3.6 バリデーション機能の実装

## 4. セキュリティ・権限管理

- [ ] 4.1 RLSポリシーの確認・調整
- [ ] 4.2 施設管理者の権限チェック実装
- [ ] 4.3 システム管理者の全施設管理権限実装

## 5. 統合・連携

- [ ] 5.1 既存コンポーネントとの統合テスト
- [ ] 5.2 役職データの一貫性確認
- [ ] 5.3 パフォーマンステスト

## 6. テスト・検証

- [ ] 6.1 データベーススキーマのテスト
- [ ] 6.2 API動作テスト
- [ ] 6.3 フロントエンド動作テスト
- [ ] 6.4 権限テスト（施設管理者・システム管理者）
- [ ] 6.5 TypeScript型チェック（`pnpm exec tsc`）
