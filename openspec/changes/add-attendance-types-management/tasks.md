## 1. データベース設計・実装

- [ ] 1.1 既存shiftsテーブルの拡張
  - [ ] 1.1.1 color_codeカラムの追加（シフト形態の色分け用）
  - [ ] 1.1.2 descriptionカラムの追加（シフト形態の説明）
  - [ ] 1.1.3 is_night_shiftカラムの追加（夜勤判定用）
  - [ ] 1.1.4 sort_orderカラムの追加（表示順序制御用）
- [ ] 1.2 インデックスと制約の設定
  - [ ] 1.2.1 施設別シフト形態の一意性制約
  - [ ] 1.2.2 パフォーマンス用インデックスの追加
- [ ] 1.3 RLSポリシーの確認・調整
- [ ] 1.4 マイグレーションファイルの作成・実行
- [ ] 1.5 ダミーデータの更新

## 2. バックエンド実装

- [ ] 2.1 シフト形態DTOの作成
  - [ ] 2.1.1 ShiftType型定義の作成
  - [ ] 2.1.2 リクエスト・レスポンス型の定義
  - [ ] 2.1.3 夜勤判定ロジックの実装
- [ ] 2.2 シフト形態リポジトリの実装
  - [ ] 2.2.1 ShiftsRepositoryクラスの作成
  - [ ] 2.2.2 シフト形態CRUD操作の実装
  - [ ] 2.2.3 施設別シフト形態取得メソッドの実装
- [ ] 2.3 tRPCルーターの実装
  - [ ] 2.3.1 シフト形態管理ルーター（shifts.ts）
    - [ ] 2.3.1.1 シフト形態一覧取得（list）
    - [ ] 2.3.1.2 シフト形態作成（create）
    - [ ] 2.3.1.3 シフト形態更新（update）
    - [ ] 2.3.1.4 シフト形態削除（delete）
    - [ ] 2.3.1.5 シフト形態並び替え（reorder）

## 3. フロントエンド実装

- [ ] 3.1 シフト形態管理コンポーネントの修正
  - [ ] 3.1.1 tRPCクライアントの統合
  - [ ] 3.1.2 シフト形態一覧の取得・表示
  - [ ] 3.1.3 シフト形態作成フォームの実装
  - [ ] 3.1.4 シフト形態編集機能の実装
  - [ ] 3.1.5 シフト形態削除機能の実装
  - [ ] 3.1.6 夜勤シフトの適切な表示・計算
- [ ] 3.2 シフト作成フォームの修正
  - [ ] 3.2.1 シフト形態選択の動的化（APIから取得）
  - [ ] 3.2.2 シフト形態に基づく勤務時間の自動計算
  - [ ] 3.2.3 夜勤シフトの適切な処理
- [ ] 3.3 シフト編集フォームの修正
  - [ ] 3.3.1 シフト形態選択の動的化
  - [ ] 3.3.2 既存シフトデータとの整合性確保
- [ ] 3.4 勤怠管理システムの修正
  - [ ] 3.4.1 シフト形態データとの連携
  - [ ] 3.4.2 勤務時間計算の正確性向上
- [ ] 3.5 施設別管理機能の実装
  - [ ] 3.5.1 施設管理者の所属施設取得
  - [ ] 3.5.2 施設別シフト形態フィルタリング
- [ ] 3.6 エラーハンドリングとローディング状態の実装
- [ ] 3.7 バリデーション機能の実装

## 4. 夜勤対応機能

- [ ] 4.1 夜勤シフトの判定ロジック実装
- [ ] 4.2 日をまたぐシフトの勤務時間計算
- [ ] 4.3 夜勤シフトの表示・入力UI改善
- [ ] 4.4 夜勤シフトの勤怠記録処理

## 5. セキュリティ・権限管理

- [ ] 5.1 RLSポリシーの確認・調整
- [ ] 5.2 施設管理者の権限チェック実装
- [ ] 5.3 システム管理者の全施設管理権限実装

## 6. 統合・連携

- [ ] 6.1 既存シフトデータとの整合性確認
- [ ] 6.2 勤怠記録との連携テスト
- [ ] 6.3 シフト作成・編集機能との統合テスト

## 7. テスト・検証

- [ ] 7.1 データベーススキーマのテスト
- [ ] 7.2 API動作テスト
- [ ] 7.3 フロントエンド動作テスト
- [ ] 7.4 夜勤シフトの動作テスト
- [ ] 7.5 権限テスト（施設管理者・システム管理者）
- [ ] 7.6 TypeScript型チェック（`pnpm exec tsc`）
